import{r as u,j as le}from"./jsx-runtime-CbkKSL4Y.js";import{u as ut,f as et,d as dt,c as ct,b as pt,m as mt,L as ht,t as ft}from"./heading-DPggoKAw.js";import{S as gt}from"./meta-BE8B7F0j.js";import{u as bt}from"./useInViewport-DEmjQroc.js";import{u as yt}from"./useWindowSize-MDlHk0QV.js";import{R as Et,e as wt,E as _t,f as ee,Q as tt,P as De,O as He,g as nt,V as ce,h as Pe,T as Re,i as Tt,H as Se,F as Ge,j as Ye,k as ke,l as Pt,C as Rt,m as St,n as Mt,W as xt,o as ot,p as vt,S as At,q as Lt,s as jt,A as Dt,D as kt,r as Ct,c as Ot,d as It,u as Ve,v as Nt,w as Ft,t as zt,x as Ht,y as Yt,z as Bt,B as Gt,G as Ut}from"./throttle-BppN56yE.js";import{u as Te}from"./use-spring-CoWiFX0D.js";import"./config-DhbiIsJ8.js";const Vt="/assets/earth-DvZudj9K.glb",Zt="/assets/milkyway-nx-Ds_hwpSC.hdr",Xt="/assets/milkyway-ny-BqhFvupA.hdr",Wt="/assets/milkyway-nz-D6l6T-pv.hdr",qt="/assets/milkyway-px-BjIdbMt0.hdr",Kt="/assets/milkyway-py-BD6pEbZF.hdr",$t="/assets/milkyway-pz-Bx3WFS88.hdr",Qt="/assets/milkyway-Vkpv7LbT.jpg";var Jt=Object.defineProperty,en=(s,a,h)=>a in s?Jt(s,a,{enumerable:!0,configurable:!0,writable:!0,value:h}):s[a]=h,i=(s,a,h)=>(en(s,typeof a!="symbol"?a+"":a,h),h);const Be=new Et,at=new wt,tn=Math.cos(70*(Math.PI/180)),rt=(s,a)=>(s%a+a)%a;class nn extends _t{constructor(a,h){super(),i(this,"object"),i(this,"domElement"),i(this,"enabled",!0),i(this,"target",new ee),i(this,"minDistance",0),i(this,"maxDistance",1/0),i(this,"minZoom",0),i(this,"maxZoom",1/0),i(this,"minPolarAngle",0),i(this,"maxPolarAngle",Math.PI),i(this,"minAzimuthAngle",-1/0),i(this,"maxAzimuthAngle",1/0),i(this,"enableDamping",!1),i(this,"dampingFactor",.05),i(this,"enableZoom",!0),i(this,"zoomSpeed",1),i(this,"enableRotate",!0),i(this,"rotateSpeed",1),i(this,"enablePan",!0),i(this,"panSpeed",1),i(this,"screenSpacePanning",!0),i(this,"keyPanSpeed",7),i(this,"zoomToCursor",!1),i(this,"autoRotate",!1),i(this,"autoRotateSpeed",2),i(this,"reverseOrbit",!1),i(this,"reverseHorizontalOrbit",!1),i(this,"reverseVerticalOrbit",!1),i(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),i(this,"mouseButtons",{LEFT:Pe.ROTATE,MIDDLE:Pe.DOLLY,RIGHT:Pe.PAN}),i(this,"touches",{ONE:Re.ROTATE,TWO:Re.DOLLY_PAN}),i(this,"target0"),i(this,"position0"),i(this,"zoom0"),i(this,"_domElementKeyEvents",null),i(this,"getPolarAngle"),i(this,"getAzimuthalAngle"),i(this,"setPolarAngle"),i(this,"setAzimuthalAngle"),i(this,"getDistance"),i(this,"listenToKeyEvents"),i(this,"stopListenToKeyEvents"),i(this,"saveState"),i(this,"reset"),i(this,"update"),i(this,"connect"),i(this,"dispose"),this.object=a,this.domElement=h,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>w.phi,this.getAzimuthalAngle=()=>w.theta,this.setPolarAngle=t=>{let n=rt(t,2*Math.PI),c=w.phi;c<0&&(c+=2*Math.PI),n<0&&(n+=2*Math.PI);let S=Math.abs(n-c);2*Math.PI-S<S&&(n<c?n+=2*Math.PI:c+=2*Math.PI),k.phi=n-c,e.update()},this.setAzimuthalAngle=t=>{let n=rt(t,2*Math.PI),c=w.theta;c<0&&(c+=2*Math.PI),n<0&&(n+=2*Math.PI);let S=Math.abs(n-c);2*Math.PI-S<S&&(n<c?n+=2*Math.PI:c+=2*Math.PI),k.theta=n-c,e.update()},this.getDistance=()=>e.object.position.distanceTo(e.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",$),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",$),this._domElementKeyEvents=null},this.saveState=()=>{e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=()=>{e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(Q),e.update(),E=p.NONE},this.update=(()=>{const t=new ee,n=new ee(0,1,0),c=new tt().setFromUnitVectors(a.up,n),S=c.clone().invert(),B=new ee,pe=new tt,Ee=2*Math.PI;return function(){const Je=e.object.position;c.setFromUnitVectors(a.up,n),S.copy(c).invert(),t.copy(Je).sub(e.target),t.applyQuaternion(c),w.setFromVector3(t),e.autoRotate&&E===p.NONE&&d(L()),e.enableDamping?(w.theta+=k.theta*e.dampingFactor,w.phi+=k.phi*e.dampingFactor):(w.theta+=k.theta,w.phi+=k.phi);let me=e.minAzimuthAngle,he=e.maxAzimuthAngle;isFinite(me)&&isFinite(he)&&(me<-Math.PI?me+=Ee:me>Math.PI&&(me-=Ee),he<-Math.PI?he+=Ee:he>Math.PI&&(he-=Ee),me<=he?w.theta=Math.max(me,Math.min(he,w.theta)):w.theta=w.theta>(me+he)/2?Math.max(me,w.theta):Math.min(he,w.theta)),w.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,w.phi)),w.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(re,e.dampingFactor):e.target.add(re),e.zoomToCursor&&f||e.object.isOrthographicCamera?w.radius=C(w.radius):w.radius=C(w.radius*G),t.setFromSpherical(w),t.applyQuaternion(S),Je.copy(e.target).add(t),e.object.matrixAutoUpdate||e.object.updateMatrix(),e.object.lookAt(e.target),e.enableDamping===!0?(k.theta*=1-e.dampingFactor,k.phi*=1-e.dampingFactor,re.multiplyScalar(1-e.dampingFactor)):(k.set(0,0,0),re.set(0,0,0));let Ae=!1;if(e.zoomToCursor&&f){let Le=null;if(e.object instanceof De&&e.object.isPerspectiveCamera){const je=t.length();Le=C(je*G);const ze=je-Le;e.object.position.addScaledVector(ne,ze),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const je=new ee(o.x,o.y,0);je.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/G)),e.object.updateProjectionMatrix(),Ae=!0;const ze=new ee(o.x,o.y,0);ze.unproject(e.object),e.object.position.sub(ze).add(je),e.object.updateMatrixWorld(),Le=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;Le!==null&&(e.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(Le).add(e.object.position):(Be.origin.copy(e.object.position),Be.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(Be.direction))<tn?a.lookAt(e.target):(at.setFromNormalAndCoplanarPoint(e.object.up,e.target),Be.intersectPlane(at,e.target))))}else e.object instanceof He&&e.object.isOrthographicCamera&&(Ae=G!==1,Ae&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/G)),e.object.updateProjectionMatrix()));return G=1,f=!1,Ae||B.distanceToSquared(e.object.position)>V||8*(1-pe.dot(e.object.quaternion))>V?(e.dispatchEvent(Q),B.copy(e.object.position),pe.copy(e.object.quaternion),Ae=!1,!0):!1}})(),this.connect=t=>{t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),e.domElement=t,e.domElement.style.touchAction="none",e.domElement.addEventListener("contextmenu",ve),e.domElement.addEventListener("pointerdown",z),e.domElement.addEventListener("pointercancel",m),e.domElement.addEventListener("wheel",ye)},this.dispose=()=>{var t,n,c,S,B,pe;e.domElement&&(e.domElement.style.touchAction="auto"),(t=e.domElement)==null||t.removeEventListener("contextmenu",ve),(n=e.domElement)==null||n.removeEventListener("pointerdown",z),(c=e.domElement)==null||c.removeEventListener("pointercancel",m),(S=e.domElement)==null||S.removeEventListener("wheel",ye),(B=e.domElement)==null||B.ownerDocument.removeEventListener("pointermove",U),(pe=e.domElement)==null||pe.ownerDocument.removeEventListener("pointerup",T),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",$)};const e=this,Q={type:"change"},P={type:"start"},l={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let E=p.NONE;const V=1e-6,w=new nt,k=new nt;let G=1;const re=new ee,M=new ce,D=new ce,W=new ce,H=new ce,Y=new ce,O=new ce,g=new ce,te=new ce,se=new ce,ne=new ee,o=new ce;let f=!1;const r=[],b={};function L(){return 2*Math.PI/60/60*e.autoRotateSpeed}function x(){return Math.pow(.95,e.zoomSpeed)}function d(t){e.reverseOrbit||e.reverseHorizontalOrbit?k.theta+=t:k.theta-=t}function y(t){e.reverseOrbit||e.reverseVerticalOrbit?k.phi+=t:k.phi-=t}const _=(()=>{const t=new ee;return function(c,S){t.setFromMatrixColumn(S,0),t.multiplyScalar(-c),re.add(t)}})(),ie=(()=>{const t=new ee;return function(c,S){e.screenSpacePanning===!0?t.setFromMatrixColumn(S,1):(t.setFromMatrixColumn(S,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(c),re.add(t)}})(),oe=(()=>{const t=new ee;return function(c,S){const B=e.domElement;if(B&&e.object instanceof De&&e.object.isPerspectiveCamera){const pe=e.object.position;t.copy(pe).sub(e.target);let Ee=t.length();Ee*=Math.tan(e.object.fov/2*Math.PI/180),_(2*c*Ee/B.clientHeight,e.object.matrix),ie(2*S*Ee/B.clientHeight,e.object.matrix)}else B&&e.object instanceof He&&e.object.isOrthographicCamera?(_(c*(e.object.right-e.object.left)/e.object.zoom/B.clientWidth,e.object.matrix),ie(S*(e.object.top-e.object.bottom)/e.object.zoom/B.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function q(t){e.object instanceof De&&e.object.isPerspectiveCamera||e.object instanceof He&&e.object.isOrthographicCamera?G/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Z(t){e.object instanceof De&&e.object.isPerspectiveCamera||e.object instanceof He&&e.object.isOrthographicCamera?G*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ue(t){if(!e.zoomToCursor||!e.domElement)return;f=!0;const n=e.domElement.getBoundingClientRect(),c=t.clientX-n.left,S=t.clientY-n.top,B=n.width,pe=n.height;o.x=c/B*2-1,o.y=-(S/pe)*2+1,ne.set(o.x,o.y,1).unproject(e.object).sub(e.object.position).normalize()}function C(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function I(t){M.set(t.clientX,t.clientY)}function ae(t){ue(t),g.set(t.clientX,t.clientY)}function ge(t){H.set(t.clientX,t.clientY)}function we(t){D.set(t.clientX,t.clientY),W.subVectors(D,M).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(d(2*Math.PI*W.x/n.clientHeight),y(2*Math.PI*W.y/n.clientHeight)),M.copy(D),e.update()}function _e(t){te.set(t.clientX,t.clientY),se.subVectors(te,g),se.y>0?q(x()):se.y<0&&Z(x()),g.copy(te),e.update()}function be(t){Y.set(t.clientX,t.clientY),O.subVectors(Y,H).multiplyScalar(e.panSpeed),oe(O.x,O.y),H.copy(Y),e.update()}function Me(t){ue(t),t.deltaY<0?Z(x()):t.deltaY>0&&q(x()),e.update()}function Ce(t){let n=!1;switch(t.code){case e.keys.UP:oe(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:oe(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:oe(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:oe(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function Oe(){if(r.length==1)M.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),n=.5*(r[0].pageY+r[1].pageY);M.set(t,n)}}function Ie(){if(r.length==1)H.set(r[0].pageX,r[0].pageY);else{const t=.5*(r[0].pageX+r[1].pageX),n=.5*(r[0].pageY+r[1].pageY);H.set(t,n)}}function R(){const t=r[0].pageX-r[1].pageX,n=r[0].pageY-r[1].pageY,c=Math.sqrt(t*t+n*n);g.set(0,c)}function v(){e.enableZoom&&R(),e.enablePan&&Ie()}function j(){e.enableZoom&&R(),e.enableRotate&&Oe()}function X(t){if(r.length==1)D.set(t.pageX,t.pageY);else{const c=Ue(t),S=.5*(t.pageX+c.x),B=.5*(t.pageY+c.y);D.set(S,B)}W.subVectors(D,M).multiplyScalar(e.rotateSpeed);const n=e.domElement;n&&(d(2*Math.PI*W.x/n.clientHeight),y(2*Math.PI*W.y/n.clientHeight)),M.copy(D)}function K(t){if(r.length==1)Y.set(t.pageX,t.pageY);else{const n=Ue(t),c=.5*(t.pageX+n.x),S=.5*(t.pageY+n.y);Y.set(c,S)}O.subVectors(Y,H).multiplyScalar(e.panSpeed),oe(O.x,O.y),H.copy(Y)}function F(t){const n=Ue(t),c=t.pageX-n.x,S=t.pageY-n.y,B=Math.sqrt(c*c+S*S);te.set(0,B),se.set(0,Math.pow(te.y/g.y,e.zoomSpeed)),q(se.y),g.copy(te)}function A(t){e.enableZoom&&F(t),e.enablePan&&K(t)}function de(t){e.enableZoom&&F(t),e.enableRotate&&X(t)}function z(t){var n,c;e.enabled!==!1&&(r.length===0&&((n=e.domElement)==null||n.ownerDocument.addEventListener("pointermove",U),(c=e.domElement)==null||c.ownerDocument.addEventListener("pointerup",T)),Fe(t),t.pointerType==="touch"?xe(t):N(t))}function U(t){e.enabled!==!1&&(t.pointerType==="touch"?Ne(t):J(t))}function T(t){var n,c,S;$e(t),r.length===0&&((n=e.domElement)==null||n.releasePointerCapture(t.pointerId),(c=e.domElement)==null||c.ownerDocument.removeEventListener("pointermove",U),(S=e.domElement)==null||S.ownerDocument.removeEventListener("pointerup",T)),e.dispatchEvent(l),E=p.NONE}function m(t){$e(t)}function N(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case Pe.DOLLY:if(e.enableZoom===!1)return;ae(t),E=p.DOLLY;break;case Pe.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;ge(t),E=p.PAN}else{if(e.enableRotate===!1)return;I(t),E=p.ROTATE}break;case Pe.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;I(t),E=p.ROTATE}else{if(e.enablePan===!1)return;ge(t),E=p.PAN}break;default:E=p.NONE}E!==p.NONE&&e.dispatchEvent(P)}function J(t){if(e.enabled!==!1)switch(E){case p.ROTATE:if(e.enableRotate===!1)return;we(t);break;case p.DOLLY:if(e.enableZoom===!1)return;_e(t);break;case p.PAN:if(e.enablePan===!1)return;be(t);break}}function ye(t){e.enabled===!1||e.enableZoom===!1||E!==p.NONE&&E!==p.ROTATE||(t.preventDefault(),e.dispatchEvent(P),Me(t),e.dispatchEvent(l))}function $(t){e.enabled===!1||e.enablePan===!1||Ce(t)}function xe(t){switch(Qe(t),r.length){case 1:switch(e.touches.ONE){case Re.ROTATE:if(e.enableRotate===!1)return;Oe(),E=p.TOUCH_ROTATE;break;case Re.PAN:if(e.enablePan===!1)return;Ie(),E=p.TOUCH_PAN;break;default:E=p.NONE}break;case 2:switch(e.touches.TWO){case Re.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;v(),E=p.TOUCH_DOLLY_PAN;break;case Re.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;j(),E=p.TOUCH_DOLLY_ROTATE;break;default:E=p.NONE}break;default:E=p.NONE}E!==p.NONE&&e.dispatchEvent(P)}function Ne(t){switch(Qe(t),E){case p.TOUCH_ROTATE:if(e.enableRotate===!1)return;X(t),e.update();break;case p.TOUCH_PAN:if(e.enablePan===!1)return;K(t),e.update();break;case p.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;A(t),e.update();break;case p.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;de(t),e.update();break;default:E=p.NONE}}function ve(t){e.enabled!==!1&&t.preventDefault()}function Fe(t){r.push(t)}function $e(t){delete b[t.pointerId];for(let n=0;n<r.length;n++)if(r[n].pointerId==t.pointerId){r.splice(n,1);return}}function Qe(t){let n=b[t.pointerId];n===void 0&&(n=new ce,b[t.pointerId]=n),n.set(t.pageX,t.pageY)}function Ue(t){const n=t.pointerId===r[0].pointerId?r[1]:r[0];return b[n.pointerId]}h!==void 0&&this.connect(h),this.update()}}class on extends Tt{constructor(a){super(a),this.type=Se}parse(a){const l=function(o,f){switch(o){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(f||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(f||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(f||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(f||""))}},w=`
`,k=function(o,f,r){f=f||1024;let L=o.pos,x=-1,d=0,y="",_=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));for(;0>(x=_.indexOf(w))&&d<f&&L<o.byteLength;)y+=_,d+=_.length,L+=128,_+=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));return-1<x?(o.pos+=d+x+1,y+_.slice(0,x)):!1},G=function(o){const f=/^#\?(\S+)/,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,b=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*FORMAT=(\S+)\s*$/,x=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,d={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let y,_;for((o.pos>=o.byteLength||!(y=k(o)))&&l(1,"no header found"),(_=y.match(f))||l(3,"bad initial token"),d.valid|=1,d.programtype=_[1],d.string+=y+`
`;y=k(o),y!==!1;){if(d.string+=y+`
`,y.charAt(0)==="#"){d.comments+=y+`
`;continue}if((_=y.match(r))&&(d.gamma=parseFloat(_[1])),(_=y.match(b))&&(d.exposure=parseFloat(_[1])),(_=y.match(L))&&(d.valid|=2,d.format=_[1]),(_=y.match(x))&&(d.valid|=4,d.height=parseInt(_[1],10),d.width=parseInt(_[2],10)),d.valid&2&&d.valid&4)break}return d.valid&2||l(3,"missing format specifier"),d.valid&4||l(3,"missing image size specifier"),d},re=function(o,f,r){const b=f;if(b<8||b>32767||o[0]!==2||o[1]!==2||o[2]&128)return new Uint8Array(o);b!==(o[2]<<8|o[3])&&l(3,"wrong scanline width");const L=new Uint8Array(4*f*r);L.length||l(4,"unable to allocate buffer space");let x=0,d=0;const y=4*b,_=new Uint8Array(4),ie=new Uint8Array(y);let oe=r;for(;oe>0&&d<o.byteLength;){d+4>o.byteLength&&l(1),_[0]=o[d++],_[1]=o[d++],_[2]=o[d++],_[3]=o[d++],(_[0]!=2||_[1]!=2||(_[2]<<8|_[3])!=b)&&l(3,"bad rgbe scanline format");let q=0,Z;for(;q<y&&d<o.byteLength;){Z=o[d++];const C=Z>128;if(C&&(Z-=128),(Z===0||q+Z>y)&&l(3,"bad scanline data"),C){const I=o[d++];for(let ae=0;ae<Z;ae++)ie[q++]=I}else ie.set(o.subarray(d,d+Z),q),q+=Z,d+=Z}const ue=b;for(let C=0;C<ue;C++){let I=0;L[x]=ie[C+I],I+=b,L[x+1]=ie[C+I],I+=b,L[x+2]=ie[C+I],I+=b,L[x+3]=ie[C+I],x+=4}oe--}return L},M=function(o,f,r,b){const L=o[f+3],x=Math.pow(2,L-128)/255;r[b+0]=o[f+0]*x,r[b+1]=o[f+1]*x,r[b+2]=o[f+2]*x,r[b+3]=1},D=function(o,f,r,b){const L=o[f+3],x=Math.pow(2,L-128)/255;r[b+0]=Ye.toHalfFloat(Math.min(o[f+0]*x,65504)),r[b+1]=Ye.toHalfFloat(Math.min(o[f+1]*x,65504)),r[b+2]=Ye.toHalfFloat(Math.min(o[f+2]*x,65504)),r[b+3]=Ye.toHalfFloat(1)},W=new Uint8Array(a);W.pos=0;const H=G(W),Y=H.width,O=H.height,g=re(W.subarray(W.pos),Y,O);let te,se,ne;switch(this.type){case Ge:ne=g.length/4;const o=new Float32Array(ne*4);for(let r=0;r<ne;r++)M(g,r*4,o,r*4);te=o,se=Ge;break;case Se:ne=g.length/4;const f=new Uint16Array(ne*4);for(let r=0;r<ne;r++)D(g,r*4,f,r*4);te=f,se=Se;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:Y,height:O,data:te,header:H.string,gamma:H.gamma,exposure:H.exposure,type:se}}setDataType(a){return this.type=a,this}load(a,h,e,Q){function P(l,p){switch(l.type){case Ge:case Se:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=ke,l.magFilter=ke,l.generateMipmaps=!1,l.flipY=!0;break}h&&h(l,p)}return super.load(a,P,e,Q)}}class an extends Pt{constructor(a){super(a),this.hdrLoader=new on,this.type=Se}load(a,h,e,Q){typeof a=="string"?a=[a]:Array.isArray(a)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(a),a=h,h=e,e=Q,Q=arguments[4]);const P=new Rt;switch(P.type=this.type,P.type){case Ge:case Se:"colorSpace"in P?P.colorSpace="srgb-linear":P.encoding=3e3,P.minFilter=ke,P.magFilter=ke,P.generateMipmaps=!1;break}const l=this;let p=0;function E(V,w,k,G){new St(l.manager).setPath(l.path).setResponseType("arraybuffer").setWithCredentials(l.withCredentials).load(a[V],function(re){p++;const M=l.hdrLoader.parse(re);if(M){if(M.data!==void 0){const D=new Mt(M.data,M.width,M.height);D.type=P.type,"colorSpace"in D?D.colorSpace=P.SRGBColorSpace:D.encoding=P.encoding,D.format=P.format,D.minFilter=P.minFilter,D.magFilter=P.magFilter,D.generateMipmaps=P.generateMipmaps,P.images[V]=D}p===6&&(P.needsUpdate=!0,w&&w(P))}},k,G)}for(let V=0;V<a.length;V++)E(V,h,e,Q);return P}setDataType(a){return this.type=a,this.hdrLoader.setDataType(a),this}}const st=(s,a,h)=>{if(h){if(Math.min(s,a)===s)return a;if(Math.max(s,h)===s)return h}else return Math.max(s,a)===a?s:a;return s},rn="_earth_4tqjk_1",sn="_loader_4tqjk_15",cn="_viewport_4tqjk_43",ln="_canvas_4tqjk_65",un="_labels_4tqjk_103",dn="_label_4tqjk_103",pn="_vignette_4tqjk_163",mn="_sections_4tqjk_187",hn="_section_4tqjk_187",fe={earth:rn,loader:sn,viewport:cn,canvas:ln,labels:un,label:dn,vignette:pn,sections:mn,section:hn},Ke={x:0,y:0,z:2},Ze=(s,a,h)=>s+h*(a-s),it=s=>Object.keys(s).map(a=>parseFloat(Math.round(s[a]*100)/100).toFixed(2)).join(", "),Xe=s=>!s||!s.camera?Ke:{x:s.camera[0],y:s.camera[1],z:s.camera[2]},fn=(s,a)=>{const h=(e=0)=>Math.round((e+Number.EPSILON)*100)/100;return h(s==null?void 0:s.x)===h(a==null?void 0:a.x)&&h(s==null?void 0:s.y)===h(a==null?void 0:a.y)&&h(s==null?void 0:s.z)===h(a==null?void 0:a.z)},We={stiffness:80,damping:40,mass:2,restSpeed:.001,restDelta:.001},qe={stiffness:40,damping:30,mass:2,restSpeed:.001,restDelta:.001},gn={stiffness:40,damping:30},lt=u.createContext({}),Mn=({position:s=[0,0,0],scale:a=1,hideMeshes:h=[],labels:e=[],className:Q,children:P})=>{const[l,p]=u.useState(!1),[E,V]=u.useState(!1),[w,k]=u.useState(!1),[G,re]=u.useState(!1),M=u.useRef([]),D=u.useRef(),W=u.useRef(),H=u.useRef(),Y=u.useRef(),O=u.useRef(),g=u.useRef(),te=u.useRef(),se=u.useRef(),ne=u.useRef(),o=u.useRef(),f=u.useRef(),r=u.useRef(),b=bt(H),L=u.useRef(),x=u.useRef(Xe(M.current[0])),d=u.useRef([]),y=u.useRef(),_=u.useRef(),ie=u.useRef(),oe=u.useRef(),{width:q,height:Z}=yt(),ue=ut(),C=Te(0,We),I=Te(0,We),ae=Te(0,We),ge=Te(0,qe),we=Te(0,qe),_e=Te(0,qe),be=Te(0,gn),Me=u.useCallback(()=>{if(!b){cancelAnimationFrame(L.current);return}L.current=requestAnimationFrame(Me);const R=te.current.getDelta();r.current.update(R),y.current.update(),O.current.render(Y.current,g.current),d.current.forEach(v=>{const{element:j,position:X,sprite:K}=v,F=new ee(...X),A=g.current.position.distanceTo(o.current.position),z=g.current.position.distanceTo(K.position)>A;F.project(g.current),F.x=Math.round((.5+F.x/2)*window.innerWidth),F.y=Math.round((.5-F.y/2)*window.innerHeight),j.style.setProperty("--posX",et(F.x)),j.style.setProperty("--posY",et(F.y)),z?j.dataset.occluded=!0:j.dataset.occluded=!1})},[b]);u.useEffect(()=>{oe.current=!0;const{innerWidth:R,innerHeight:v}=window;O.current=new xt({canvas:H.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),O.current.setPixelRatio(1),O.current.outputColorSpace=ot,O.current.toneMapping=vt,g.current=new De(54,R/v,.1,100),g.current.position.x=x.current.x,g.current.position.y=x.current.y,g.current.position.z=x.current.z,g.current.lookAt(0,0,0),C.set(g.current.position.x,!1),I.set(g.current.position.y,!1),ae.set(g.current.position.z,!1),Y.current=new At,te.current=new Lt,ne.current=new jt;const j=new Dt(2236962,.05),X=new kt(16777215,1.5);X.position.set(3,0,1);const K=[j,X];return K.forEach(F=>Y.current.add(F)),y.current=new nn(g.current,H.current),y.current.enableZoom=!1,y.current.enablePan=!1,y.current.enableDamping=!1,y.current.rotateSpeed=.5,()=>{oe.current=!1,cancelAnimationFrame(L.current),Ct(K),Ot(Y.current),It(O.current)}},[]),u.useEffect(()=>{const R=()=>{V(!0),C.stop(),I.stop(),ae.stop()},v=()=>{C.set(g.current.position.x,!1),I.set(g.current.position.y,!1),ae.set(g.current.position.z,!1),V(!1)};return y.current.addEventListener("start",R),y.current.addEventListener("end",v),()=>{y.current.removeEventListener("start",R),y.current.removeEventListener("end",v)}},[C,I,ae]),u.useEffect(()=>{if(!l)return;const R=Ve("Chunk",o.current),v=Ve("Atmosphere",o.current),j=(m,N)=>{g.current.position[m]=N},X=C.on("change",m=>j("x",m)),K=I.on("change",m=>j("y",m)),F=ae.on("change",m=>j("z",m)),A=(m,N)=>{R.position[m]=N},de=ge.on("change",m=>A("x",m)),z=we.on("change",m=>A("y",m)),U=_e.on("change",m=>A("z",m)),T=be.on("change",m=>{v.material.opacity=m});return()=>{X(),K(),F(),de(),z(),U(),T()}},[C,I,ae,ge,we,_e,l,be]),u.useEffect(()=>{q<=dt.tablet&&(y.current.enabled=!1)},[q]),u.useEffect(()=>{if(l)return;const R=new an,v=new Nt(O.current);v.compileCubemapShader();const j=async()=>{const A=await Ht.loadAsync(Vt);o.current=A.scene,f.current=A.animations,r.current=new Yt(o.current),r.current.timeScale=.1,o.current.traverse(async de=>{const{material:z,name:U}=de;U==="Atmosphere"&&(z.alphaMap=z.map),z&&await O.current.initTexture(z)}),o.current.position.x=s[0],o.current.position.y=s[1],o.current.position.z=s[2],o.current.scale.x=a,o.current.scale.y=a,o.current.scale.z=a},X=async()=>{const A=await R.loadAsync([Zt,Xt,Wt,qt,Kt,$t]);A.magFilter=ke,_.current=v.fromCubemap(A),v.dispose(),await O.current.initTexture(_.current.texture)},K=async()=>{const A=await Bt.loadAsync(Qt);A.mapping=Gt,A.colorSpace=ot,Y.current.background=A,await O.current.initTexture(A)},F=async()=>{await Promise.all([K(),X(),j()]),o.current.traverse(({material:A})=>{A&&(A.envMap=_.current.texture,A.needsUpdate=!0)}),oe.current&&p(!0)};u.startTransition(()=>{F(),setTimeout(()=>{re(!0)},1e3)})},[l,s,a]),u.useEffect(()=>(l&&!ie.current&&(Y.current.add(o.current),ie.current=!0),l&&b&&(k(!0),Me()),()=>{cancelAnimationFrame(L.current)}),[Me,b,l]),u.useEffect(()=>{l&&(W.current.innerHTML="",d.current=e.map(R=>{const v=document.createElement("div");v.classList.add(fe.label),v.dataset.hidden=!0,v.style.setProperty("--delay",`${R.delay||0}ms`),v.textContent=R.text,W.current.appendChild(v);const j=new Ft;return j.position.set(...R.position),j.scale.set(60,60,1),{element:v,...R,sprite:j}}))},[e,l]),u.useEffect(()=>{O.current.setSize(q,Z),g.current.aspect=q/Z,g.current.updateProjectionMatrix()},[q,Z]),u.useEffect(()=>{const R=H.current,v=j=>{const{innerWidth:X,innerHeight:K}=window,F=it(g.current.position);console.info({cameraPosition:F}),se.current=new ce(j.clientX/X*2-1,-(j.clientY/K)*2+1),ne.current.setFromCamera(se.current,g.current);const A=ne.current.intersectObjects(Y.current.children,!0);if(A.length>0){const de=it(A[0].point);console.info({clickPosition:de})}};return()=>{R.removeEventListener("click",v)}},[]);const Ce=u.useCallback(()=>{if(!D.current)return;const{offsetTop:R}=D.current,{innerHeight:v}=window,j=window.scrollY-R;let X;const K=z=>{const U=M.current[z].meshes;o.current.traverse(T=>{const{name:m}=T,N=Ve("Chunk",o.current),J=U==null?void 0:U.includes(m),ye=h==null?void 0:h.includes(m);if(J)if(m==="Atmosphere")T.visible=!0,be.set(1);else if(m==="Chunk"){const $=new ee(-.4,.4,.4);T.visible=!0,ue?T.position.set(...$.toArray()):(ge.set($.x),we.set($.y),_e.set($.z))}else m==="EarthFull"&&N.visible?T.visible=!1:T.visible=!0;else if(ye&&!J)if(m==="Atmosphere")be.set(0);else if(m==="Chunk"){const $=new ee(0,0,0);fn($,N.position)&&(T.visible=!1),ge.set($.x),we.set($.y),_e.set($.z)}else m==="EarthPartial"&&N.visible?T.visible=!0:T.visible=!1})},F=z=>{const U=M.current[z].animations;ue||(f.current.forEach((T,m)=>{U.find(N=>N.includes(m.toString()))||r.current.clipAction(T).reset().stop()}),f.current.length&&M.current[z].animations&&U.forEach(T=>{const m=T.split(":"),N=f.current[Number(m[0])],J=r.current.clipAction(N);(!m[1]||m[1]!=="loop")&&(J.clampWhenFinished=!0,J.loop=Ut),J.play()}))},A=z=>{d.current.forEach(T=>{T.hidden&&(T.element.dataset.hidden=!0,T.element.setAttribute("aria-hidden",!0))}),M.current[z].labels.forEach(T=>{d.current.filter(N=>N.text===T).forEach(N=>{N.element.dataset.hidden=!1,N.element.setAttribute("aria-hidden",!1)})})};requestAnimationFrame(()=>{const z=M.current.length-1,U=Math.floor(j/v),T=st(U,0,z),m=M.current[T],N=M.current[T+1],J=Xe(m)||Ke,ye=Xe(N)||Ke,$=(j-v*T)/v,xe=st($,0,1),Ne=Ze(J.x,ye.x,xe),ve=Ze(J.y,ye.y,xe),Fe=Ze(J.z,ye.z,xe);if(X!==J&&M.current.length&&m&&(K(T),F(T),A(T)),X=J,!E){if(ue){g.current.position.set(Ne,ve,Fe);return}C.set(Ne),I.set(ve),ae.set(Fe)}})},[C,I,ae,ge,we,_e,E,h,be,ue]);u.useEffect(()=>{const R=zt(Ce,100);return l&&b&&window.addEventListener("scroll",R),()=>{window.removeEventListener("scroll",R)}},[Ce,b,l,be]);const Oe=u.useCallback(R=>{M.current=[...M.current,R]},[]),Ie=u.useCallback(R=>{M.current=M.current.filter(v=>v!==R)},[]);return le.jsx(lt.Provider,{value:{registerSection:Oe,unregisterSection:Ie},children:le.jsxs("div",{className:ct(fe.earth,Q),ref:D,children:[le.jsxs("div",{className:fe.viewport,children:[le.jsx("canvas",{className:fe.canvas,"data-visible":l&&w,"data-grabbing":E,ref:H}),le.jsx("div",{className:fe.labels,"aria-live":"polite",ref:W}),le.jsx("div",{className:fe.vignette})]}),le.jsx("div",{className:fe.sections,children:P}),le.jsx(pt,{unmount:!0,in:!l&&G,timeout:mt(ft.base.durationL),children:R=>le.jsx(gt,{className:fe.loader,"data-visible":R,children:le.jsx(ht,{})})})]})})},xn=u.memo(({children:s,scrim:a,scrimReverse:h,className:e,camera:Q=[0,0,0],animations:P=[],meshes:l=[],labels:p=[]})=>{const{registerSection:E,unregisterSection:V}=u.useContext(lt),w=u.useRef(),k=JSON.stringify(P)+JSON.stringify(Q)+JSON.stringify(p)+JSON.stringify(l);return u.useEffect(()=>{const G={camera:Q,animations:P,meshes:l,labels:p,sectionRef:w};return E(G),()=>{V(G)}},[k,E,V]),le.jsx("div",{className:ct(fe.section,e),"data-scrim":a,"data-scrim-reverse":h,ref:w,children:s})});export{Mn as Earth,xn as EarthSection};
